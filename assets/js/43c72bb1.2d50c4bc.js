"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7293],{4402:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>l,frontMatter:()=>i,metadata:()=>t,toc:()=>h});var n=s(4848),a=s(8453);const i={sidebar_position:2},c="Graphcast CLI",t={id:"graphcast/radios/graphcast-cli",title:"Graphcast CLI",description:"The source code for the Graphcast CLI is available on GitHub.",source:"@site/docs/graphcast/radios/graphcast-cli.md",sourceDirName:"graphcast/radios",slug:"/graphcast/radios/graphcast-cli",permalink:"/graphcast/radios/graphcast-cli",draft:!1,unlisted:!1,editUrl:"https://github.com/graphops/docs/edit/main/docs/graphcast/radios/graphcast-cli.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"gnSidebar",previous:{title:"HTTP Server",permalink:"/graphcast/radios/subgraph-radio/http-server"},next:{title:"Listener Radio",permalink:"/graphcast/radios/listener-radio"}},d={},h=[{value:"Introduction",id:"introduction",level:2},{value:"Usage",id:"usage",level:2},{value:"Run with Docker",id:"run-with-docker",level:3},{value:"(or) Run using a pre-built binary",id:"or-run-using-a-pre-built-binary",level:3},{value:"(or) Run using a pre-built binary",id:"or-run-using-a-pre-built-binary-1",level:3}];function o(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.header,{children:(0,n.jsx)(r.h1,{id:"graphcast-cli",children:"Graphcast CLI"})}),"\n",(0,n.jsxs)(r.p,{children:["The source code for the Graphcast CLI is available ",(0,n.jsx)(r.a,{href:"https://github.com/graphops/graphcast-cli",children:"on GitHub"}),"."]}),"\n",(0,n.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsxs)(r.p,{children:["The Graphcast CLI enables sending one-off messages. Currently, it can be used for the ",(0,n.jsx)(r.a,{href:"https://docs.graphops.xyz/graphcast/design-principles#subgraph-upgrade-pre-sync",children:"Subgraph Upgrade Pre-sync feature"})," of Subgraph Radio."]}),"\n",(0,n.jsx)(r.p,{children:"The Graphcast CLI is configured using config variables. You will need to prepare the following config variables (either as env variables or passing CLI args when running the CLI):"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Name"}),(0,n.jsx)(r.th,{children:"Description and Examples"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"PRIVATE_KEY"})}),(0,n.jsxs)(r.td,{children:["Private key to the Graphcast ID wallet (precendence over mnemonics).",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)(r.code,{children:"PRIVATE_KEY=YOUR_PRIVATE_KEY"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"MNEMONIC"})}),(0,n.jsxs)(r.td,{children:["Mnemonic to the Graphcast ID wallet (first address of the wallet is used; Only one of private key or mnemonic is needed).",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)(r.code,{children:"MNEMONIC=YOUR_MNEMONIC"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"GRAPH_ACCOUNT"})}),(0,n.jsxs)(r.td,{children:["Graph account corresponding to Graphcast operator.",(0,n.jsx)("br",{}),"Example: ",(0,n.jsx)(r.code,{children:"GRAPH_ACCOUNT=YOUR_GRAPH_ACCOUNT"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"REGISTRY_SUBGRAPH"})}),(0,n.jsxs)(r.td,{children:["Subgraph endpoint to the Graphcast Registry.",(0,n.jsx)("br",{}),"Default: ",(0,n.jsx)(r.code,{children:"https://api.thegraph.com/subgraphs/name/hopeyen/graphcast-registry-goerli"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"NETWORK_SUBGRAPH"})}),(0,n.jsxs)(r.td,{children:["Subgraph endpoint to The Graph network subgraph.",(0,n.jsx)("br",{}),"Default: ",(0,n.jsx)(r.code,{children:"https://api.thegraph.com/subgraphs/name/graphprotocol/graph-network-goerli"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"GRAPHCAST_NETWORK"})}),(0,n.jsxs)(r.td,{children:["Supported Graphcast networks: mainnet, testnet.",(0,n.jsx)("br",{}),"Default: ",(0,n.jsx)(r.code,{children:"testnet"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"LOG_LEVEL"})}),(0,n.jsxs)(r.td,{children:["Logging configuration to set as RUST_LOG.",(0,n.jsx)("br",{}),"Default: ",(0,n.jsx)(r.code,{children:"info"})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"LOG_FORMAT"})}),(0,n.jsxs)(r.td,{children:["Support logging formats: pretty, json, full, compact.",(0,n.jsx)("br",{}),"Default: ",(0,n.jsx)(r.code,{children:"pretty"})]})]})]})]}),"\n",(0,n.jsx)(r.p,{children:"The Graphcast CLI code is very extensible and could be altered to send any kind of Graphcast-compatible message to the network."}),"\n",(0,n.jsx)(r.h2,{id:"usage",children:"Usage"}),"\n",(0,n.jsxs)(r.p,{children:["The Graphcast CLI supports the following subcommands - ",(0,n.jsx)(r.code,{children:"upgrade-presync"})," and ",(0,n.jsx)(r.code,{children:"indexing-status"}),". Both of them work with additional configuration options:"]}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{children:"Name"}),(0,n.jsx)(r.th,{children:"Description and Examples"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"SUBGRAPH_ID"})}),(0,n.jsx)(r.td,{children:"Subgraph id shared by the old and new deployment."})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.code,{children:"NEW_HASH"})}),(0,n.jsx)(r.td,{children:"Subgraph hash for the upgrade version of the subgraph."})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.code,{children:"upgrade-presync"})," subcommand has an additional ",(0,n.jsx)(r.code,{children:"MAX_RETRY"})," variable, which specifies the number of retries for the subcommand. The default value is ",(0,n.jsx)(r.code,{children:"5"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"Below you can see examples of working CLI commands."}),"\n",(0,n.jsx)(r.h3,{id:"run-with-docker",children:"Run with Docker"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Pull the Graphcast CLI image"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"docker pull ghcr.io/graphops/graphcast-cli:latest\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"2",children:["\n",(0,n.jsx)(r.li,{children:"Run the image, providing the required configuration variables. Here's a sample configuration:"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'docker run ghcr.io/graphops/graphcast-cli \\\n    --private-key "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef" \\\n    --graph-account "0xe9a1cabd57700b17945fd81feefba82340d9568f" \\\n    upgrade-presync --new-hash "QmVVfLWowm1xkqc41vcygKNwFUvpsDSMbHdHghxmDVmH9x" \\\n    --subgraph-id "CnJMdCkW3pr619gsJVtUPAWxspALPdCMw6o7obzYBNp3"\n'})}),"\n",(0,n.jsx)(r.h3,{id:"or-run-using-a-pre-built-binary",children:"(or) Run using a pre-built binary"}),"\n",(0,n.jsxs)(r.p,{children:["We also provide pre-built binaries for Ubuntu and MacOS, which you can find in the ",(0,n.jsx)(r.code,{children:"Assets"})," section on each release in the ",(0,n.jsx)(r.a,{href:"https://github.com/graphops/graphcast-cli/releases",children:"releases page"})," on Github. Simply download the binary, make it executable (",(0,n.jsx)(r.code,{children:"chmod a+x ./graphcast-cli-{TAG}-{SYSTEM}"}),") and then run it (using ",(0,n.jsx)(r.code,{children:"./graphcast-cli-{TAG}-{SYSTEM}"}),"), like this:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'./graphcast-cli-0.0.1-macos \\\n    --private-key "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef" \\\n    --graph-account "0xe9a1cabd57700b17945fd81feefba82340d9568f" \\\n    upgrade-presync --new-hash "QmVVfLWowm1xkqc41vcygKNwFUvpsDSMbHdHghxmDVmH9x" \\\n    --subgraph-id "CnJMdCkW3pr619gsJVtUPAWxspALPdCMw6o7obzYBNp3"\n'})}),"\n",(0,n.jsx)(r.h3,{id:"or-run-using-a-pre-built-binary-1",children:"(or) Run using a pre-built binary"}),"\n",(0,n.jsxs)(r.ol,{children:["\n",(0,n.jsx)(r.li,{children:"Clone the repo"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"git clone https://github.com/graphops/graphcast-cli.git\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"2",children:["\n",(0,n.jsx)(r.li,{children:"Navigate to the project directory"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"cd graphcast-cli\n"})}),"\n",(0,n.jsxs)(r.ol,{start:"3",children:["\n",(0,n.jsx)(r.li,{children:"Run the CLI"}),"\n"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:'cargo run --release -- --private-key "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef" \\\n    --graph-account "0xe9a1cabd57700b17945fd81feefba82340d9568f" \\\n    upgrade-presync --new-hash "QmVVfLWowm1xkqc41vcygKNwFUvpsDSMbHdHghxmDVmH9x" \\\n    --subgraph-id "CnJMdCkW3pr619gsJVtUPAWxspALPdCMw6o7obzYBNp3"\n'})})]})}function l(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(o,{...e})}):o(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>c,x:()=>t});var n=s(6540);const a={},i=n.createContext(a);function c(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),n.createElement(i.Provider,{value:r},e.children)}}}]);