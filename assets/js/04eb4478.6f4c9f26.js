"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2439],{8123:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var s=r(4848),t=r(8453);const o={sidebar_position:5},a="HTTP Server",i={id:"graphcast/radios/subgraph-radio/http-server",title:"HTTP Server",description:"The Radio spins up an HTTP server with a GraphQL API when SERVERHOST and SERVERPORT environment variables are set. The supported routes are:",source:"@site/docs/graphcast/radios/subgraph-radio/http-server.md",sourceDirName:"graphcast/radios/subgraph-radio",slug:"/graphcast/radios/subgraph-radio/http-server",permalink:"/graphcast/radios/subgraph-radio/http-server",draft:!1,unlisted:!1,editUrl:"https://github.com/graphops/docs/edit/main/docs/graphcast/radios/subgraph-radio/http-server.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"gnSidebar",previous:{title:"Advanced Configuration",permalink:"/graphcast/radios/subgraph-radio/advanced-configuration"},next:{title:"Graphcast CLI",permalink:"/graphcast/radios/graphcast-cli"}},d={},c=[];function l(e){const n={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"http-server",children:"HTTP Server"})}),"\n",(0,s.jsxs)(n.p,{children:["The Radio spins up an HTTP server with a GraphQL API when ",(0,s.jsx)(n.code,{children:"SERVER_HOST"})," and ",(0,s.jsx)(n.code,{children:"SERVER_PORT"})," environment variables are set. The supported routes are:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/health"})," for health status"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"/api/v1/graphql"})," for GET and POST requests with GraphQL playground interface"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The GraphQL API now includes several advanced queries:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"radioPayloadMessages"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"localAttestations"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"upgradeIntentMessages"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"comparisonResults"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"comparisonRatio"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Below are some example queries:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:'query {\n  radioPayloadMessages {\n    identifier\n    nonce\n    signature\n    graphAccount\n    payload {\n      identifier\n      content\n    }\n  }\n  localAttestations {\n    deployment\n    blockNumber\n    attestation {\n      ppoi\n    }\n  }\n  comparisonResults(identifier: "Qm...") {\n    deployment\n    blockNumber\n    resultType\n    localAttestation {\n      ppoi\n    }\n    attestations {\n      senders\n      stakeWeight\n      ppoi\n    }\n  }\n  comparisonRatio {\n    deployment\n    blockNumber\n    stakeRatio\n  }\n  upgradeIntentMessages {\n    subgraphId\n    newHash\n    nonce\n    graphAccount\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["You can customize the returned data from the ",(0,s.jsx)(n.code,{children:"comparisonRatio"})," query by providing optional arguments - ",(0,s.jsx)(n.code,{children:"deployment"}),", ",(0,s.jsx)(n.code,{children:"block"})," and ",(0,s.jsx)(n.code,{children:"resultType"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-graphql",children:'query {\n  comparisonRatio(deployment: "Qm...", block: 17887350, resultType: MATCH) {\n    deployment\n    blockNumber\n    stakeRatio\n  }\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["In this example, the ",(0,s.jsx)(n.code,{children:"stakeRatio"}),' query will return the stake ratios only for attestations from deployment "Qm..." and block number 17887350, and only for the specified result type.']}),"\n",(0,s.jsxs)(n.p,{children:["Note: The ",(0,s.jsx)(n.code,{children:"result_type"})," field of the filter corresponds to the ",(0,s.jsx)(n.code,{children:"resultType"})," field in the ",(0,s.jsx)(n.code,{children:"comparisonResults"})," query. This field represents the type of comparison result."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"stakeRatio"})," orders the attestations by stake weight, then computes the ratio of unique senders."]}),"\n",(0,s.jsxs)(n.p,{children:["To understand more about the format of the ratio results, check out ",(0,s.jsx)(n.a,{href:"#poi-comparison-results",children:"this section"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"These queries provide a clear aggregation of the attestations from remote messages, giving a concise understanding of the Radio's state. The optional filters - deployment, block, and filter - can be used to refine the results."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>i});var s=r(6540);const t={},o=s.createContext(t);function a(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);