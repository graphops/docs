<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-launchpad/guides/kubernetes-guide">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Kubernetes Guide | GraphOps Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.graphops.xyz/launchpad/guides/kubernetes-guide"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes Guide | GraphOps Docs"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.graphops.xyz/launchpad/guides/kubernetes-guide"><link data-rh="true" rel="alternate" href="https://docs.graphops.xyz/launchpad/guides/kubernetes-guide" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.graphops.xyz/launchpad/guides/kubernetes-guide" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="GraphOps Docs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="GraphOps Docs Atom Feed"><link rel="stylesheet" href="/assets/css/styles.b3d4b999.css">
<link rel="preload" href="/assets/js/runtime~main.0d7ef15e.js" as="script">
<link rel="preload" href="/assets/js/main.dbd9f55e.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="GraphOps Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="GraphOps Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/launchpad/intro">Launchpad</a><a class="navbar__item navbar__link" href="/graphcast/intro">Graphcast</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/graphops/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Docs on GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/modularity">Modularity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/prerequisites">Prerequisites</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/release-channels">Release Channels</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/supported-namespaces">Supported Namespaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/design-principles">Design Principles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/client-side-tooling">Client Side Tooling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/server-side-stack">Server Side Stack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/faq">Frequently Asked Questions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/launchpad/other-resources">Other Resources</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/launchpad/guides/arbitrum-archive-kubernetes-guide">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/guides/arbitrum-archive-kubernetes-guide">Arbitrum Archive Mainnet Node Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/guides/avalanche-archive-kubernetes">Avalanche Archive Mainnet Node Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/guides/celo-archive-kubernetes-guide">Celo Archive Mainnet Node Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/guides/goerli-indexer-guide">Goerli Indexer Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/guides/install-fcos">FCOS Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/launchpad/guides/kubernetes-guide">Kubernetes Guide</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/launchpad/advanced/advanced-kubernetes">Advanced Topics</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/launchpad/advanced/advanced-kubernetes">Considerations for Kubernetes installation using FCOS</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kubernetes Guide</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Kubernetes Guide</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><p>[Kubernetes]<!-- -->(<a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/</a> is the container orchestration system emerging as the victor of the container wars.
Some of its characteristics that stand out are:</p><ul><li>being opensource</li><li>having an API designed to be easily extended</li><li>following a design pattern based on controllers and reconciliation loops</li></ul><p>The major components that make up k8s are:</p><ul><li><strong>etcd:</strong> a key-value store </li><li><strong>kube-apiserver:</strong> exposes the Kubernetes API </li><li><strong>kube-controller-manager:</strong> single binary that combines a variety of controllers</li><li><strong>kube-scheduler:</strong> assigns containers to nodes</li><li><strong>kubelet:</strong> responsible for setting up containers</li><li><strong>kube-proxy:</strong> manages iptables rules in order to implement the Kubernetes service abstraction</li></ul><p>Being a multi-node clustered system, Kubernetes topology distinguishes between two different roles:</p><ul><li><strong>control-plane</strong> nodes: these are the nodes that run <em>kube-apiserver</em>, <em>kube-controller-manager</em>, and in some setups also <em>etcd</em> nodes (<em>etcd</em> could, potentially, run externally in its own independent nodes)</li><li><strong>worker</strong> nodes: these need to run mostly <em>kubelet</em>, as their purpose is focused on running the workload containers</li></ul><p>Setting up, and bootstrapping a cluster involves installing and configuring all the required components, certificates management, and container manifests that make up the system. There are numerous options and tools to achieve this goal, but performing manual bootstrapping is a highly educational experience: <a href="https://github.com/kelseyhightower/kubernetes-the-hard-way" target="_blank" rel="noopener noreferrer">Kubernetes - The Hard Way</a>).</p><p>This guide utilizes <a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/" target="_blank" rel="noopener noreferrer">Kubeadm</a> - a tool used to bootstrap and manage the lifecycle of a Kubernetes cluster (upgrade versions, add/remove nodes). It automates the process of setting up a cluster and provides a consistent way of doing it while preserving almost as much control over the setup as a purely manual one.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2><ul><li>At least a node configured with your Linux OS of choice and swap disabled - recent Kubernetes versions allow the host to have swap enabled, but that is a new feature not yet in GA (General Availability) and requires extra setup.</li><li>The <a href="https://kubernetes.io/docs/setup/production-environment/container-runtimes/" target="_blank" rel="noopener noreferrer">container runtime</a> of choice. We favored CRI-O, and would recommend that one. </li><li>Installing the required binaries: <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/" target="_blank" rel="noopener noreferrer">Documentation</a><ul><li>kubelet</li><li>kubeadm</li><li>kubectl (the CLI tool to talk to your cluster)</li></ul></li></ul><p><strong>Note:</strong> Pay attention that all the binaries, and the chosen CRI, are of matching compatible versions.</p><p>Lastly, there is one networking setup requirement, or choice: there needs to be an endpoint for the control-plane API (an IP address, and optionally, a DNS that resolves to that IP). In the special case of a single-node cluster, picking the IP of the listening interface fits the bill. But, more generally, one would either setup a Load Balancer if setting up the cluster on a Cloud Provider, and use that Load Balancer&#x27;s IP / DNS, or in case of a multi-node control-plane in bare metal, one may setup something such as <a href="https://keepalived.readthedocs.io/en/latest/introduction.html" target="_blank" rel="noopener noreferrer">Keepalived</a> to have a floating IP suitable to be used as the control-plane endpoint.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bootstrapping-a-cluster-with-kubeadm">Bootstrapping a cluster with Kubeadm<a href="#bootstrapping-a-cluster-with-kubeadm" class="hash-link" aria-label="Direct link to Bootstrapping a cluster with Kubeadm" title="Direct link to Bootstrapping a cluster with Kubeadm">​</a></h2><p>A feature that stands out in <em>kubeadm</em> is the ability to customize almost every option of the underlying components. That configuration is passed via flags to <em>kubeadm</em>, or ingested via YAML files.
<em>Kubeadm</em> always bootstraps a cluster as a single control-plane node, and other nodes are added after the bootstrapping.</p><p>We&#x27;re going to create a YAML file instead of passing all the options as flags to <em>kubeadm</em>.
Create a cluster-config.yaml file as the following:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> InitConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kubeletExtraArgs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">cgroup-driver</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> systemd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">taints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> kubeadm.k8s.io/v1beta3</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> ClusterConfiguration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">networking</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">serviceSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.96.0.0/16&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">podSubnet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;10.10.0.0/16&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kubernetesVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;v1.25.9&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">controlPlaneEndpoint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> &lt;endpoint_ip_or_dns</span><span class="token punctuation" style="color:rgb(199, 146, 234)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>where you must replace <code>&lt;endpoint_ip_or_dns&gt;</code> by the control-plane&#x27;s endpoint and, optionally, choose a different podSubnet and/or serviceSubnet. Documentation on all the many configuration options available can be found <a href="https://kubernetes.io/docs/reference/config-api/kubeadm-config.v1beta3/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>next, you can use <em>kubeadm</em> to bootstrap the cluster with:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm init </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">upload</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">certs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">config cluster</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">config.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>after which, if all goes well, one should see output similar to this:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">root@demo /</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kubeadm init</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I0515 </span><span class="token number" style="color:rgb(247, 140, 108)">19</span><span class="token plain">:48:51.424146 </span><span class="token number" style="color:rgb(247, 140, 108)">1642628</span><span class="token plain"> version.go:256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> remote version is much newer: v1.27.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> falling back to: stable-1.25</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Using Kubernetes version: v1.25.9</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">preflight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Running pre-flight checks</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">preflight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Pulling images required </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> setting up a Kubernetes cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">preflight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> This might take a minute or two, depending on the speed of your internet connection</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">preflight</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> You can also perform this action </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> beforehand using </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;kubeadm config images pull&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Using certificateDir folder </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/pki&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ca&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;apiserver&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> apiserver serving cert is signed </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> DNS names </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">demo kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> and IPs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">10.96</span><span class="token plain">.0.1 </span><span class="token number" style="color:rgb(247, 140, 108)">134.177</span><span class="token plain">.177.107</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;apiserver-kubelet-client&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;front-proxy-ca&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;front-proxy-client&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;etcd/ca&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;etcd/server&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> etcd/server serving cert is signed </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> DNS names </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">demo localhost</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> and IPs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">134.177</span><span class="token plain">.177.107 </span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1 ::1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;etcd/peer&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> etcd/peer serving cert is signed </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> DNS names </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">demo localhost</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> and IPs </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">134.177</span><span class="token plain">.177.107 </span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1 ::1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;etcd/healthcheck-client&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;apiserver-etcd-client&quot;</span><span class="token plain"> certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Generating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sa&quot;</span><span class="token plain"> key and public key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubeconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Using kubeconfig folder </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubeconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;admin.conf&quot;</span><span class="token plain"> kubeconfig </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubeconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubelet.conf&quot;</span><span class="token plain"> kubeconfig </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubeconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;controller-manager.conf&quot;</span><span class="token plain"> kubeconfig </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubeconfig</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;scheduler.conf&quot;</span><span class="token plain"> kubeconfig </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubelet-start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing kubelet environment </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> with flags to </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/var/lib/kubelet/kubeadm-flags.env&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubelet-start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Writing kubelet configuration to </span><span class="token function" style="color:rgb(130, 170, 255)">file</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/var/lib/kubelet/config.yaml&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubelet-start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Starting the kubelet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Using manifest folder </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/manifests&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating static Pod manifest </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kube-apiserver&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating static Pod manifest </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kube-controller-manager&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating static Pod manifest </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kube-scheduler&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">etcd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating static Pod manifest </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">local</span><span class="token plain"> etcd </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/manifests&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">wait-control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Waiting </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> the kubelet to boot up the control plane as static Pods from directory </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/manifests&quot;</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">.</span><span class="token plain"> This can take up to 4m0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">apiclient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> All control plane components are healthy after </span><span class="token number" style="color:rgb(247, 140, 108)">4.502328</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">upload-config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Storing the configuration used </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> ConfigMap </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubeadm-config&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> the </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kube-system&quot;</span><span class="token plain"> Namespace</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubelet</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating a ConfigMap </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubelet-config&quot;</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> namespace kube-system with the configuration </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> the kubelets </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> the cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">upload-certs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Skipping phase. Please see --upload-certs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mark-control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Marking the </span><span class="token function" style="color:rgb(130, 170, 255)">node</span><span class="token plain"> demo as control-plane by adding the labels: </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">mark-control-plane</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Marking the </span><span class="token function" style="color:rgb(130, 170, 255)">node</span><span class="token plain"> demo as control-plane by adding the taints </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">node-role.kubernetes.io/control-plane:NoSchedule</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Using token: 4y3umx.fnuv7v9pgp4jn74b</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Configured RBAC rules to allow Node Bootstrap tokens to get nodes</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Configured RBAC rules to allow Node Bootstrap tokens to post CSRs </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> order </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> nodes to get long term certificate credentials</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Configured RBAC rules to allow certificate rotation </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> all </span><span class="token function" style="color:rgb(130, 170, 255)">node</span><span class="token plain"> client certificates </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> the cluster</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">bootstrap-token</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Creating the </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cluster-info&quot;</span><span class="token plain"> ConfigMap </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> the </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kube-public&quot;</span><span class="token plain"> namespace</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">kubelet-finalize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Updating </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/etc/kubernetes/kubelet.conf&quot;</span><span class="token plain"> to point to a rotatable kubelet client certificate and key</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">addons</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Applied essential addon: CoreDNS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">addons</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> Applied essential addon: kube-proxy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Your Kubernetes control-plane has initialized successfully</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To start using your cluster, you need to run the following as a regular user:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">mkdir</span><span class="token plain"> -p </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/.kube</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> -i /etc/kubernetes/admin.conf </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/.kube/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">chown</span><span class="token plain"> </span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">id</span><span class="token variable" style="color:rgb(191, 199, 213)"> -u</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">:</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">id</span><span class="token variable" style="color:rgb(191, 199, 213)"> -g</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(130, 170, 255)">$HOME</span><span class="token plain">/.kube/config</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Alternatively, </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> you are the root user, you can run:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">KUBECONFIG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/etc/kubernetes/admin.conf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You should now deploy a pod network to the cluster.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Run </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;kubectl apply -f [podnetwork].yaml&quot;</span><span class="token plain"> with one of the options listed at:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can now </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> any number of control-plane </span><span class="token function" style="color:rgb(130, 170, 255)">node</span><span class="token plain"> by running the following </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">command</span><span class="token plain"> on each as a root:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866 --control-plane --certificate-key f8902e114ef118304e561c3ecd4d0b543adc226b7a07f675f56564185ffe0c07</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that the certificate-key gives access to cluster sensitive data, keep it secret</span><span class="token operator" style="color:rgb(137, 221, 255)">!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">As a safeguard, uploaded-certs will be deleted </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> two hours</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"> If necessary, you can use kubeadm init phase upload-certs to reload certs afterward.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Then you can </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> any number of worker nodes by running the following on each as root:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm </span><span class="token function" style="color:rgb(130, 170, 255)">join</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">192.168</span><span class="token plain">.0.200:6443 --token 9vr73a.a8uxyaju799qwdjv --discovery-token-ca-cert-hash sha256:7c2e69131a36ae2a042a339b33381c6d0d43887e2de83720eff5359e26aec866</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>(<em>Note</em>: Save these <code>kubeadm join</code> commands presented in this output, as they contain secrets that will be required to add more nodes in future steps.)</p><p>this being a control-plane node, <em>kubeadm</em> will have created a <em>kubeconfig</em> file in /etc/kubernetes/admin.conf. A <em>kubeconfig</em> file is a YAML file that contains the required metadata and credentials to talk to the cluster, such as certificates/tokens and endpoint specification. <em>Kubectl</em> will use whatever <em>kubeconfig</em> file is pointed at by the KUBECONFIG environment variable, or, by default, the file in <code>~/.kube/config</code>. So, as suggested in the output, we should do:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">KUBECONFIG</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">/etc/kubernetes/admin.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>now <em>kubectl</em> should be setup to interact your the cluster. Try it by doing the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">root@demo /</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># kubectl get nodes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">NAME   STATUS   ROLES           AGE   VERSION</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">demo   Ready    control-plane   10s   v1.25.9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-a-cni">Installing a CNI<a href="#installing-a-cni" class="hash-link" aria-label="Direct link to Installing a CNI" title="Direct link to Installing a CNI">​</a></h2><p>Kubernetes follows a very modular API interface based design. Some of those components, like the CSI (<a href="https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/</a> ) CNI (<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/" target="_blank" rel="noopener noreferrer">https://kubernetes.io/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/</a>) or Ingress controller, come together to form the core of most kubernetes platform setups.</p><p>The CNI is the module that will take care of enabling networking between containers and services in different nodes, or setup each container&#x27;s networking properties. As such, it is a critical next step in order to add more nodes to the cluster, or even run workload containers.</p><p>We have chosen to use <a href="https://github.com/cilium/cilium/" target="_blank" rel="noopener noreferrer">cilium</a> as a CNI solution, but there are <a href="https://github.com/containernetworking/cni/" target="_blank" rel="noopener noreferrer">many options</a> to choose from.</p><p>We&#x27;ll go ahead and fetch the cilium binary from upstream by running the following script:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CILIUM_CLI_VERSION</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token variable" style="color:rgb(191, 199, 213)">$(</span><span class="token variable function" style="color:rgb(130, 170, 255)">curl</span><span class="token variable" style="color:rgb(191, 199, 213)"> -s https://raw.githubusercontent.com/cilium/cilium-cli/master/stable.txt</span><span class="token variable" style="color:rgb(191, 199, 213)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">CLI_ARCH</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">amd64</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">cd</span><span class="token plain"> /usr/local/bin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> -L --fail --remote-name-all https://github.com/cilium/cilium-cli/releases/download/</span><span class="token variable" style="color:rgb(191, 199, 213)">${CILIUM_CLI_VERSION}</span><span class="token plain">/cilium-linux-</span><span class="token variable" style="color:rgb(191, 199, 213)">${CLI_ARCH}</span><span class="token plain">.tar.gz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">,.sha256sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sha256sum --check cilium-linux-</span><span class="token variable" style="color:rgb(191, 199, 213)">${CLI_ARCH}</span><span class="token plain">.tar.gz.sha256sum</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">tar</span><span class="token plain"> xzvfC cilium-linux-</span><span class="token variable" style="color:rgb(191, 199, 213)">${CLI_ARCH}</span><span class="token plain">.tar.gz /usr/local/bin</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">rm</span><span class="token plain"> cilium-linux-</span><span class="token variable" style="color:rgb(191, 199, 213)">${CLI_ARCH}</span><span class="token plain">.tar.gz</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">,.sha256sum</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and then proceed to install cilium with default options by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/usr/local/bin/cilium </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-more-control-plane-nodes">Adding more control-plane nodes<a href="#adding-more-control-plane-nodes" class="hash-link" aria-label="Direct link to Adding more control-plane nodes" title="Direct link to Adding more control-plane nodes">​</a></h2><p>If you have gone with the default topology setup, <em>kubeadm</em> should be instantiating <em>etcd</em> instances co-located with your control-plane nodes. Given that and the fact that <em>etcd</em> is a majority quorum based system, it&#x27;s specially important that for a high-availability setup you&#x27;ll keep an <strong><em>odd</em></strong> (i.e: one, thee, five, ...) number of control-plane nodes. As such, the minimum number of control-plane nodes that can offer high-availability would be three.</p><p>To add more control-plane nodes you need to first get the hosts ready for such by:</p><ul><li>preparing the node OS as required</li><li>provisioning the required tools and software as in the first bootstrapping node (container runtime engine, kubelet, kubeadm, kubectl, ...)</li></ul><p>and then execute, on that node, the appropriate <code>kubeadm join</code> command as shown in the previous <code>kubeadm init</code> output.
For a control-plane node, that takes the form:
<code>kubeadm join &lt;endpoint&gt; --token &lt;secret&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt; --control-plane --certificate-key &lt;secret&gt;</code></p><p><em>Note</em>: the <code>kubeadm join</code> commands shown after bootstrapping the cluster or, rather, the secrets uploaded and displayed are temporary and expire after a certain time. In case you lost them or they&#x27;ve expired, you can re-upload new certificates and display the new ones, on the bootstrapping control-plane node, by running:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm init phase upload-certs --upload-certs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm token create --print-join-command</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="adding-worker-nodes">Adding worker nodes<a href="#adding-worker-nodes" class="hash-link" aria-label="Direct link to Adding worker nodes" title="Direct link to Adding worker nodes">​</a></h2><p>To add worker nodes to your cluster, first get them ready for such by:</p><ul><li>preparing the node OS as required</li><li>provisioning the required tools and software as in the first bootstrapping node (container runtime engine, kubelet, kubeadm, kubectl, ...)</li></ul><p>Next, you can run the appropriate <code>kubeadm join</code> command that was displayed at cluster bootstrap. It has the form:
<code>kubeadm join &lt;endpoint&gt; --token &lt;secret&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;</code></p><p>In case you haven&#x27;t saved that output, you can run (on one of the existing control-plane cluster members) the following command:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#243D42"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">kubeadm token create --print-join-command</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>which will display you the appropriate kubeadm join command and the relevant secrets, again.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/graphops/docs/edit/main/docs/launchpad/guides/kubernetes-guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/launchpad/guides/install-fcos"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">FCOS Installation</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/launchpad/advanced/advanced-kubernetes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Considerations for Kubernetes installation using FCOS</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#bootstrapping-a-cluster-with-kubeadm" class="table-of-contents__link toc-highlight">Bootstrapping a cluster with Kubeadm</a></li><li><a href="#installing-a-cni" class="table-of-contents__link toc-highlight">Installing a CNI</a></li><li><a href="#adding-more-control-plane-nodes" class="table-of-contents__link toc-highlight">Adding more control-plane nodes</a></li><li><a href="#adding-worker-nodes" class="table-of-contents__link toc-highlight">Adding worker nodes</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Graph Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/graphprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/graphprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/graphprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Indexer Office Hours</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/TheGraphIOH" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCQ7G_cCufIVUdUUUf-jdoVA" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube Recordings<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://graphops.notion.site/Indexer-Office-Hours-952e0b50a65144768aab922e2c9d102a" target="_blank" rel="noopener noreferrer" class="footer__link-item">All Prior Calls &amp; Agendas<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">GraphOps</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/graphopsxyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/graphops" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://graphops.xyz" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"> </div></div></div></footer></div>
<script src="/assets/js/runtime~main.0d7ef15e.js"></script>
<script src="/assets/js/main.dbd9f55e.js"></script>
</body>
</html>